#import "@preview/touying:0.4.2": *
#import "@preview/ctheorems:1.1.2": *
#import "@preview/mitex:0.2.4": *
#import "@preview/cuti:0.2.1": show-cn-fakebold
#show: show-cn-fakebold

#show: thmrules


#let theorem = thmbox("theorem", "å®šç†", fill: rgb("#c2dcc2"))
#let corollary = thmplain(
  "corollary",
  "æ¨è®º",
  base: "theorem",
  titlefmt: strong
)
#let definition = thmbox("definition", "å®šä¹‰", inset: (x: 1.2em, top: 1em)).with(numbering: "1")

#let example = thmplain("example", "ä¾‹å­").with(numbering: none)
#let prob = thmplain("prob", "é—®é¢˜", inset: (x: 1.2em, top: 1em, bottom:1em)).with(fill: 
rgb("#dfebdf")).with(numbering: none)

#let prop = thmplain("prop", "æ€§è´¨", inset: (x: 1.2em, top: 1em, bottom:1em)).with(fill: 
rgb("#def5c3")).with(numbering: "1.")

#let proof = thmproof("proof", "è¯æ˜")

#let s = themes.university.register(aspect-ratio: "4-3")
#let s = (s.methods.info)(
  self: s,
  title: [7. æ•°è®ºåŸºç¡€],
  author: [å¼ æ¡„ç®(gwzhang\@cug.edu.cn)],
  date: datetime.today(),
  institution: [éƒ‘å·ä¸€ä¸­(Legacy)],
)
#let (init, slides) = utils.methods(s)
#show: init


#let (slide, empty-slide) = utils.slides(s)
#show: slides

= æ•´é™¤å…³ç³»

== åŸºæœ¬å®šä¹‰ä¸æ€§è´¨

- æ•´é™¤è®°å·: æŠŠå› å­æŠ“åˆ°å‰é¢(Def1.1)
- æœ€å¤§å…¬çº¦æ•°(Def1.2)
  - å¯ä»¥ç”¨ä½œåŒ–ç®€
  - ç‰¹æ®Šæƒ…å†µ: æ³¨æ„0çš„æƒ…å½¢
- æœ€å°å…¬å€æ•°(Def1.3)

æœ€å°å…¬å€æ•°å’Œæœ€å¤§å…¬çº¦æ•°æœ‰ä»€ä¹ˆè”ç³»?

- å¸¸è§çš„è¯æ˜æ–¹æ³•: è¡¨ç¤ºä¸º$n=m k$.

== æ±‚æœ€å¤§å…¬çº¦æ•°(Euclidç®—æ³•)

- å¤§å®¶éƒ½çŸ¥é“$gcd(a, b)=gcd(b, a mod b)$

```cpp
int gcd(int a,int b){
    if(b==0) return a;
    return gcd(b,a%b);
}
```

è¯æ˜è¿™ä»¶äº‹å°±è¦è¯·å‡ºæ‰©å±•Euclidç®—æ³•. 
- è§£ç­”çš„åŒæ—¶è¿˜å¯ä»¥å¸®åŠ©å¾—åˆ°ä¸€ä¸ªä¸å®šæ–¹ç¨‹çš„ä¸€ç»„è§£! 



== ğŸ“š é™¤æ³•è¡¨è¾¾å¼(div-prob)

#slide[
#prob[
  ç»™å‡ºä¸€ä¸ªè¿™æ ·çš„é™¤æ³•è¡¨è¾¾å¼: $X_1\/X_2\/X_3\/X_4\/X_5\/X_6....\/X_k$,

æ­£å¸¸çš„é™¤æ³•è¡¨è¾¾å¼æ˜¯ä»å·¦å¾€å³è®¡ç®—çš„, ä½†æ˜¯æˆ‘ä»¬å¯ä»¥å‘å…¶ä¸­æ·»åŠ æ‹¬å·, ä»¥æ”¹å˜å®ƒçš„è¿ç®—é¡ºåº, å¦‚1/2/1/2=1/4,  (1/2)/(1/2)=1  ;

é‚£ä¹ˆï¼Œ  ç»™å®šä¸€ä¸ªé™¤æ³•è¡¨è¾¾å¼ï¼Œèƒ½å¦é€šè¿‡æ·»åŠ æ‹¬å·ä½¿å®ƒçš„å€¼ä¸ºæ­£æ•´æ•°ï¼Ÿ
]
]

è€ƒè™‘æ•´é™¤çš„æ€§è´¨, æœ€åå¿…é¡»ä¸º$X_1X_2...X_k/X_2$çš„å½¢å¼ -- å³
- ä¸€å †æ”¾åœ¨åˆ†å­, ä¸€ä¸ªæ”¾åœ¨åˆ†æ¯. 
- å¦‚æœåˆ†æ¯æ”¾å¾—å¤šçš„è¯åè€Œä¼šå˜å¾—æ›´ "ä¸æ•´". 

çº¦åˆ†: æ¯æ¬¡çº¦åˆ†æ‰$X_i$å’Œ$X_2$çš„$gcd$. 
- æ•´æ•° $<==>$ $X_2=1$. 


== æ‰©å±•Euclidç®—æ³•

#prob[æ±‚å‡ºæ»¡è¶³$a x+b y=gcd(a,b)$çš„$(x,y)$çš„è§£ç­”.]

æ±‚ä¸€ç»„ç‰¹è§£: 

```cpp
int exgcd(int a, int b, int &x, int &y){
    if(b==0) {x=1,y=0;return a;}
    int r = exgcd(b,a%b,x,y);
    tie(x,y) = make_tuple(y,x-(a/b)*y);
    return r;
}
```

è¯æ˜æ–¹æ³•: æ•°å­¦å½’çº³æ³•; 

å‡è®¾æœ‰äº†ä¸€ä¸ªè§£$(x_1, y_1)$. å¦‚ä½•å¾—åˆ°å…¶ä»–çš„è§£?

- å–å¦ä¸€ç»„è§£$(x_2, y_2)$, you $a x_1+b y_1=a x_2 + b y_2=gcd(a,b)$
- ä»¥$a,b$æå–ç³»æ•°: $a(x_1-x_2)=b(y_2-y_1)$, ä¸¤è¾¹åŒæ—¶é™¤ä»¥$g:=gcd(a,b)$
- å¾—åˆ°$a'(x_1-x_2)=b'(y_2-y_1)$. ($a'=a/g, b'=b/g$).

#prop[
  è®¾$a,b,c in ZZ$, ä¸€æ—¦æ‰¾åˆ°ä¸€ç»„$a x+b y=c$çš„æ•´æ•°è§£$x_0, y_0$, å®ƒçš„å…¶ä»–è§£å¯ä»¥å†™ä½œ$(x_0+k b', y_0 - k a')$.
]

ç”±$a x + b y = gcd(x, y)$å¾—åˆ°$a x + b y=c$:
- ä¾‹å¦‚$6 times (-2) + 15 times 1 = 3$, åŒæ—¶ä¹˜3å³å¯å¾—åˆ°$6 times (-6) +15 times 3 = 9$.

== ğŸ“š P1516 é’è›™çš„çº¦ä¼š

#slide[
  #prob[
    æˆ‘ä»¬æŠŠè¿™ä¸¤åªé’è›™åˆ†åˆ«å«åšé’è›™ A å’Œé’è›™ B , å¹¶ä¸”è§„å®šçº¬åº¦çº¿ä¸Šä¸œç» 0 åº¦å¤„ä¸ºåŸç‚¹, ç”±ä¸œå¾€è¥¿ä¸ºæ­£æ–¹å‘,å•ä½é•¿åº¦ 1 ç±³, è¿™æ ·æˆ‘ä»¬å°±å¾—åˆ°äº†ä¸€æ¡é¦–å°¾ç›¸æ¥çš„æ•°è½´ã€‚è®¾é’è›™ A çš„å‡ºå‘ç‚¹åæ ‡æ˜¯ $x$, é’è›™ B çš„å‡ºå‘ç‚¹åæ ‡æ˜¯ $y$ ã€‚é’è›™ A ä¸€æ¬¡èƒ½è·³ $m$ ç±³, é’è›™ B ä¸€æ¬¡èƒ½è·³ $n$ ç±³, ä¸¤åªé’è›™è·³ä¸€æ¬¡æ‰€èŠ±è´¹çš„æ—¶é—´ç›¸åŒã€‚çº¬åº¦çº¿æ€»é•¿ $L$ ç±³ã€‚ç°åœ¨è¦ä½ æ±‚å‡ºå®ƒä»¬è·³äº†å‡ æ¬¡ä»¥åæ‰ä¼šç¢°é¢ã€‚
  ]
]

è¦æ±‚: 

$
(x+k m) mod l &= (y+k n) mod l \
  => (x+k m)-(y+ k n)&=l z,z in ZZ \
  x-y+k(m-n)-l z=0
  $

è°æ˜¯å¸¸æ•°, æ˜¯æ˜¯å˜é‡?

$
  k(m-n)-l z &= -(x-y) \
  -k(n-m) - l z &= -(x-y) \
  k(n-m) + l z &= x-y
$

è¦è§£çš„æ˜¯$(k, l)$. ä½¿ç”¨`exgcd`å³å¯. 

ç±»ä¼¼ç»ƒä¹ : P1082; P3811

== æ•´é™¤ä¸æ±‚å’Œä½œç”¨çš„ç»“æœ

- å› æ•°çš„å…±è½­æ€§è´¨
- æ±‚å’Œè®°å·çš„äº¤æ¢

= è´¨æ•°ä¸åˆæ•°

== åŸºæœ¬å®šä¹‰

- è´¨æ•°
- åˆæ•°

== å”¯ä¸€åˆ†è§£å®šç†ä¸æ¯ä¸ªæ•°çš„åæ ‡

- å”¯ä¸€åˆ†è§£å®šä¹‰(è¯æ˜)
- æ•´æ•°åæ ‡(æ— ç©·ç»´ç©ºé—´); 

== ğŸ“š UVA10375 é€‰æ‹©ä¸é™¤æ³•

è€ƒè™‘æ¯ä¸ªç´ æ•°çš„æŒ‡æ•°ä½ç½®, æœ€åæ±‚è§£. 

== ğŸ“š CF582A GCD Table

é‡è¦è§‚å¯Ÿ: ä¸¤ä¸ªæ•°çš„$gcd$ä¸€å®šä¸å¤§äºä¸¤ä¸ªæ•°. 
- $gcd(a,b) <= min(a,b)$

æ‰¾åˆ°ç¬¬ä¸€å¤§å’Œç¬¬äºŒå¤§çš„æ•°
- å°†åŸæ¥çš„$n times n$ä»å¤§åˆ°å°æ’åº. 
- æœ€å¤§çš„ä¸¤ä¸ªæ•°æ˜¯$a_1, a_2$.

ç¬¬ä¸‰å¤§çš„æ•°å‘¢?
- ä¸ä¸€å®šåœ¨åŸæ•°åˆ—é‡Œé¢, å¯èƒ½æ˜¯æœ€å¤§çš„é‚£ä¸¤ä¸ªçš„$gcd$. 
- æŠŠ$gcd(a_1, a_2)$å»æ‰, ä¹ŸæŠŠ$gcd(a_2, a_1)$å»æ‰. 
- å¨èƒè§£é™¤!!

æ¯æ¬¡æŠŠæ•°è¡¨ä¸­çš„æœ€å¤§å€¼å–å‡ºæ¥ï¼Œå®ƒæ˜¯åŸæ•°åˆ—ä¸­çš„æ•°ã€‚ç„¶åï¼ŒæŠŠå®ƒä¸ä¹‹å‰è¢«å–å‡ºæ¥çš„ $gcd$éƒ½ä»æ•°è¡¨ä¸­å‰”é™¤ã€‚å¦‚æ­¤å¾ªç¯å¾€å¤, ç›´åˆ°å–æ»¡$n$ä¸ªæ•°æˆ–æ•°è¡¨è¢«å–ç©ºä¸ºæ­¢ã€‚

== æ±‚å’Œå¼çš„äº¤æ¢

== æ±‚å’Œå¼çš„ä¸€ç§åšæ³•: æšä¸¾ç­”æ¡ˆ

=== a) Iversonæ‹¬å·ä¸æ±‚å’Œè®°å·

- åŸºæœ¬å®šä¹‰
- ä¸¤ä¸ªIversonæ‹¬å·çš„åˆå¹¶ä¸æ‹†åˆ†

=== b) æšä¸¾ç­”æ¡ˆ: ä¸‹å–æ•´ä¸ºä¾‹

- è€ƒè™‘ç­”æ¡ˆçš„å€¼
- ä¸‹å–æ•´çš„æ€§è´¨

== ğŸ“š CQOI2007 ä½™æ•°æ±‚å’Œ

$
sum_(i=1)^n k mod i& = sum_(i=1)^n k-i floor(k/i)\
&=n k-sum_(i=1)^n i floor(k/i)
$

- ç„¶åæšä¸¾$floor(k/i)$çš„ç­”æ¡ˆæ¥åš(å‡å®š$k=5$)

```
    i       1  2  3  4  5  6  7  8  9  10
ceil(5/i)   5  2  1  1  1  0  0  0  0  0
```

æšä¸¾å·¦ç«¯ç‚¹ç®—å³ç«¯ç‚¹: 

$
t <= k/i < t+1 \
ceil(k/(t+1))<i<=floor(k/t)
$

== ğŸ“š UVA12716 GCD=XOR

å›é¡¾`xor`çš„æ€§è´¨: ä¸è¿›/é€€ä½çš„äºŒè¿›åˆ¶åŠ /å‡æ³• 
- $a-b <= a xor b <= a+b $;
- $a xor b = c ==> a xor c = b$;

è¦æ±‚
$
sum_(i=1)^n sum_(j=1)^n [gcd(i,j) = i xor j],
$

å¯ä»¥æšä¸¾ç­”æ¡ˆ, è€ƒå¯Ÿ$gcd$çš„å€¼è®°ä¸º$d$: 
$
sum_(d=1)^n sum_(d \\ i) [gcd(i, i xor d)=d].
$

ä½†æ˜¯è¿˜æ˜¯ä¼šTLE, è€ƒè™‘$gcd$çš„å¤§å°å…³ç³».

== è´¨æ•°ç­›æ³•

- Eratosthenesç­›æ³•

```cpp
void Prime(){
	for(int i=2;i<=N;i++){
		if(notp[i]==0){
			prime[++cnt] = i;
			for(int j=2*i; j<=N;j+=i){
				notp[j] = 1;
				
			}
		}
	}
}
```

- Eulerç­›
  - æ¯ä¸ªæ•°åªä¼šè¢«å…¶æœ€å°çš„è´¨å› æ•°ç­›æ‰
  - å’Œå”¯ä¸€åˆ†è§£å®šç†æ‰“å¾ˆå¥½çš„é…åˆ


```cpp
void Prime(){
	for(int i=2;i<=N;i++){
		if(notp[i]==0){
			prime[++cnt] = i;
			for(int j=2*i; j<=N;j+=i){
				notp[j] = 1;
				
			}
		}
	}
}
```

è·å¾—ä¸€ä¸ªåŒºé—´é‡Œé¢çš„è´¨æ•°. 

== æœ‰ç†æ•°æ˜¯å¯æ•°çš„å—?

æ˜¯çš„. å¯ä»¥ä½¿ç”¨Stern-Brocotæ ‘è¯´æ˜. 

= æ¨¡è¿ç®—

== åŸºæœ¬è¿ç®—è§„åˆ™

- å®šä¹‰ä¸è®°å·
- åŠ , å‡(æ³¨æ„å…ˆåŠ æ¨¡æ•°), ä¹˜æ³•
  - é˜²æ­¢æº¢å‡º: å¢åŠ `-sanitizer=undefined`
- å¿«é€Ÿå¹‚

== ğŸ“š P1226 å¿«é€Ÿå¹‚å–ä½™

#prob[è®¡ç®—$a b mod k$.]

== é™¤æ³•ä¸é€†å…ƒ

è¢«çº¦å»çš„æ•°å’Œå½“å‰çš„æ¨¡æ•°äº’è´¨çš„æƒ…å†µä¸‹, æ‰å¯ä»¥çº¦å». 


== ğŸ“š UVA11582 

#slide[
  #prob[
      #mitext(`è¾“å…¥ä¸¤ä¸ªéè´Ÿæ•´æ•° $a, b$ å’Œæ­£æ•´æ•° $n\left(0 \leq a, b<2^{64}, 1 \leq n \leq 10^3\right)$, æ±‚ $f\left(a^b\right) \bmod n$ çš„å€¼, å…¶ä¸­ $f_0=0, f_1=1, f_{i+2}=f_i+f_{i+1}(i \geq 0)$ ã€‚`)
  ]
]

- æœ‰å–æ¨¡: è€ƒè™‘æ˜¯ä¸æ˜¯æœ‰å¾ªç¯èŠ‚? (Yes!)

æ·±å…¥ç†è®º: 

- #mitext(`ä¸€ä¸ªæ•° $\bmod n$, æœ‰ $n$ ç§å¯èƒ½ $(\{m : 0 \leq m<n\})$ . ä¸€ä¸ªäºŒå…ƒç»„ $\left(f_i \bmod n, f_{i-1} \bmod n\right), i>$ æœ‰ $n \times n$ ç§.`)
- #mitext(`è‹¥ä¸€ä¸ªäºŒå…ƒç»„ $\left(f_q, f_{q-1}\right)=\left(f_p, f_p-1\right) 0<q, p$, é‚£å®ƒä»¬ä¹‹åçš„æ‰€æœ‰æ•°ä¹Ÿä¼šå‡ºç°å¾ªç¯.`)

== ğŸ“š P2613 æœ‰ç†æ•°å–ä½™

- ç±»ä¼¼äºæ±‚ä¹˜æ³•

ç»å¸¸å‡ºç°åœ¨ä¸ºäº†é¿å…å°æ•°ç‚¹åçš„ç²¾åº¦çš„é—®é¢˜. 

== è§£çº¿æ€§åŒä½™æ–¹ç¨‹ç»„

(ex)crt: å°†å¤šä¸ªå¼å­ä¸¤ä¸¤åˆå¹¶, åŒ–ä¸ºä¸€ä¸ª. 

= æ•°è®ºå‡½æ•°

== ç®€ä»‹

- å®šä¹‰åŸŸå’Œå€¼åŸŸé€šå¸¸åœ¨æ•´æ•°ä¸Šé¢

== Eulerå‡½æ•°

- å®šä¹‰
- æ±‚æ³•1: è€ƒè™‘å½’çº³çš„æ–¹æ³•

```cpp
int prime[MAXN], phi[MAXN], cnt = 0; bool notp[MAXN];
int main(){
	for(int i =2;i<=N;i++){
		if(notp[i]==0){
			prime[++cnt] = i; phi[i] = i-1; // æ˜¯è´¨æ•°
		}
		for(int j=1;i*prime[j]<=N&&j<=cnt;j++){
			notp[i*prime[j]] =1;
			if(i % prime[j] == 0) {
				phi[i*prime[j]] = phi[i] * phi[prime[j]];
				break;
			}else{phi[i*prime[j]] = (j-1)*phi[i];}
		}
	}
}
```

== ç§¯æ€§å‡½æ•°

- å®šä¹‰

== Mobiuså‡½æ•°

- å‘æ˜çš„åŠ¨æœº

```cpp
for (int i = 2; i <= N; i++) {
    if (!notp[i]) {  // i is a prime number
        prime[++cnt] = i;
        mu[i] = -1;
    }
    for (int j = 1; j <= cnt && i * prime[j] <= N; j++) {
        notp[i * prime[j]] = true;

        if (i % prime[j] == 0) {
            mu[i * prime[j]] = 0;  
            break;
        } else {
            mu[i * prime[j]] = mu[i] * mu[prime[j]];  
        }
    }
}
```


== ğŸ“š P2158 ä»ªä»—é˜Ÿ

- å·¦ä¸‹è§’å½“åšåæ ‡è½´çš„åŸç‚¹(0,0)
- è¢«çœ‹åˆ°çš„äººæ»¡è¶³$gcd(x, y) =1$æˆç«‹. 

$
&sum_(i=0)^(n-1) sum_(j=0) ^(n-1) [gcd(i,j)=1] \
=&2sum_(i=1)^(n-1) sum_(j=1) ^(i-1) [gcd(i,j)=1]+3\
=& 2 (sum_(i=1)^(n-1) phi(i))+3\
=&2sum_(i=1)^(n-1)phi(i)+3.
$