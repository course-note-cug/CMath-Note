%!TEX TS-program = xelatex

\documentclass{ctexart}
\input{../include.tex}
\input{../ncmd.tex}

\begin{document}


\section{上取整和下取整} 
\label{sec:intro}

实际上, 上取整和下取整实际上英语是对应着房子的``天花板''和``地板''. 

\incfig{fl-illus}

\subsection{基本定义} 

\begin{definition}[上取整和下取整]
    $\forall x \in \mathbb{R}$, 定义下取整函数和上取整函数
    \begin{align*}
    \lfloor x\rfloor:= \text{最大的} \leqslant x \text{的整数}\\
    \lceil x\rceil := \text{最小的} \geqslant x\text{ 的整数}
    \end{align*}
    分别称他们为``上取整函数''和``下取整函数 ''.
    
\end{definition}

\begin{example}绘制出下取整函数的图像
    \incfig{floor}
   上取整函数的图像也是同理.  
\end{example}

\begin{prop}
    取整函数有如下的三个性质: 

    \begin{enumerate}
        \item $\lfloor x\rfloor=x \iff$ $x$是正数 $\iff $ $\lceil x\rceil=x$.
        \item (放缩) $x-1<\lfloor x\rfloor \leqslant x \leqslant\lceil x\rceil<x+1$.
        \item (对称)$\lfloor-x\rfloor=-\lceil x\rceil, \quad F x\rceil=-\lfloor x\rfloor$.
    \end{enumerate}
    
\end{prop}

\begin{prop}
    实际上, 上下取整函数是对一类不等式的缩写

    $$
\lfloor x\rfloor=n\left\{\begin{array}{lll}
    \iff & x-n \leqslant x & \text {(固定}x\text{,考察 } n \text { 的范围) } \\
\iff & n \leqslant x \leqslant n+1 & \text { (固定}n\text{, 考察 } x \text { 的范围 })
\end{array}\right.
$$

$$
\lceil x\rceil=n \begin{cases}\iff & x \leqslant n \leqslant x+1 \\ \iff & n-1<x \leqslant n .\end{cases}
$$

    
\end{prop}

\begin{corollary}
    若$n \in \mathbb{Z},\lfloor x+n\rfloor=\lfloor x\rfloor+n$.
    
\end{corollary}

\begin{remark}
    实际上, 这一个性质经常用于将整数(也许是配凑出来的)移入或者移出取整记号中. 
\end{remark}

为了更加彰显不等式的地位, 特别有下面的一个不等式.

\begin{prop}[上下取整的不等式]

$$ 
\begin{gathered}
x<n \Leftrightarrow\lfloor x\rfloor<n ; \quad n<x \Leftrightarrow n<\lceil x\rceil . \\
x \leqslant n \Leftrightarrow\lceil x\rceil \leqslant n ; \quad n \leqslant x \Leftrightarrow n \leqslant\lfloor x\rfloor .
\end{gathered}
$$ 

\end{prop}

这是一个重要的式子. 可以通过分类讨论的方法证明之. 

\begin{definition}[分数部分] 定义一个数的分数部分为$x-\lfloor x\rfloor$. 如果与集合的记号不相冲突的话, 可以记作$\set{x}$. 
    
\end{definition}

\begin{example}
    $\lfloor x+y\rfloor$是否永远等于$\lfloor x\rfloor+\lfloor y\rfloor$?
    实际上不是这样的. 将$x,y$写作$x=\lfloor x\rfloor+\{x\}, \quad y=\lfloor y\rfloor+\{y\}$, 那么
\[
    \lfloor x+y\rfloor=\lfloor x\rfloor+\lfloor y\rfloor+\lfloor\{x\}+\{y\}\rfloor
\]
    我们发现当且仅当$\{x\}+\{y\}<1$ 时, $\lfloor x+y\rfloor=\lfloor x\rfloor+\lfloor y\rfloor$. 否则由于$0 \leqslant\{x\}+\{y\}<2$, 其为$\lfloor x\rfloor+\lfloor y\rfloor+1$. 
\end{example}

\subsection{上取整, 下取整的复合} 我们首先考察一些基本例子得到的结果. 

\begin{example}
    $\lceil\lfloor x\rfloor\rceil=\lfloor x\rfloor ;\lfloor\lceil x\rceil\rfloor=\lceil x\rceil$. 直接将两者复合得到的结果是平凡的. 
    
\end{example}

\begin{example}
    证明或推翻: $\lfloor\sqrt{\lfloor x\rfloor}\rfloor=\lfloor\sqrt{x}\rfloor$.

首先尝试举反例, 但是$\pi, e, \phi, 1,2 \cdots$都是正确的, 于是考虑证明. 

我们的目标为想办法除去$\sqrt{ }$下的$\lfloor\rfloor$. 假设$m:=\lfloor\sqrt{\lfloor x\rfloor}\rfloor$, 解掉最外层的底可以得到
$$
m \leqslant \sqrt{\lfloor x\rfloor}<m+1
$$

$$
\begin{aligned}
& \Rightarrow m^2 \leqslant\lfloor x\rfloor<(m+1)^2 \\
& \Rightarrow m^2 \leqslant x<(m+1)^2 . \Longrightarrow m \leqslant \sqrt{x}<(m+1)^2 \\
& \Rightarrow m \leqslant\lfloor\sqrt{x}\rfloor<(m+1)^2 .
\end{aligned}
$$
    
\end{example}

考虑泛化上述的例子. 

\begin{theorem}
    令$f(x)$为一个连续, 单调递增的函数, 满足
    \[
        f(x) \text{是整数} \implies x\text{是整数}. 
    \]

    那么有
    $$
\lfloor f(x)\rfloor=\lfloor f(\lfloor x\rfloor)\rfloor,\lceil f(x)\rceil=\lceil f(\lceil x \rceil)\rceil .
$$
只要$f(x), f(\lfloor x\rfloor), f(\lceil x\rceil)$有定义. 
\end{theorem}

\begin{proof}
    $1^\circ$ 如果$x$是整数, 那么显然成立. 

    $2^\circ$ 若$x>\lfloor x\rfloor$, 由于$f$单调递增, 那么$f(x)>f(\lfloor x\rfloor)$. 然后两端同时取下取整符号, 由于下取整记号不减, 那么$\lfloor f(x)\rfloor \geqslant\lfloor f(\lfloor x\rfloor)\rfloor$. 我们接下来分类讨论, 以确定大于号的情形不成立. 
    \begin{itemize}
        \item 如果$\lfloor f(x)\rfloor =\lfloor f(\lfloor x\rfloor)\rfloor$, 那么这就是我们想要的. 
        \item 如果$\lfloor f(x)\rfloor>\lfloor f(\lfloor x\rfloor)\rfloor$, 那么由于$f$是一个连续的函数, 一定存在$y$, 使得$\lfloor x\rfloor \leqslant y<x$, 并且$f(y)=\lfloor f(\lfloor x\rfloor)\rfloor$. 根据$f$的性质, $y$一定也是整数. 但是$\lfloor x\rfloor$与$x$之间不存在另一个整数, 矛盾! 所以我们的假设不成立.  
    \end{itemize}
\end{proof}

\begin{corollary}
    $$
\left\lfloor\frac{x+m}{n}\right\rfloor=\left\lfloor\frac{\lfloor x\rfloor+m}{n}\right\rfloor,\left\lceil\frac{x+m}{n}\right\rceil=\left\lceil\frac{\lceil x\rceil+m}{n}\right\rceil .
$$
    
\end{corollary}

比如, $$
\lfloor\lfloor\lfloor x / 10\rfloor / 10\rfloor / 10\rfloor=\lfloor x / 1000\rfloor .
$$

\subsection{区间计数问题} 

如果我们用如下的简写记后面的区间:
$$
\begin{cases}
    [\alpha..\beta] & \alpha \leqslant x \leqslant \beta\\
    (\alpha..\beta]& \alpha<x \leqslant \beta \\
    [\alpha..\beta) & \alpha \leq x<\beta\\
    (\alpha..\beta)& \alpha<x<\beta
\end{cases}$$

我们的问题是这个集合里面包含了多少个整数.($\alpha,\beta$不一定是整数). 

首先, 简化考虑的问题情形. 如果$\alpha,\beta$均为整数, 那么数量就是
\[
    \beta-\alpha+\text{``[''的个数}-1
\]

然后, 考虑转换, 因为
$$
\begin{aligned}
& \alpha \leqslant n<\beta \quad \Leftrightarrow\lceil\alpha\rceil \leqslant n<\lceil\beta\rceil \\
& \alpha<n \leqslant \beta \quad \Leftrightarrow\lfloor\alpha\rfloor<n \leqslant[\beta\rfloor
\end{aligned}
$$
所以余下二者仅需要补充上``$+1$''或者$``-1''$. 也就是
$$
\begin{array}{ll}
{[\alpha .. \beta]} & \lfloor\beta\rfloor-\lceil \alpha\rceil+1 \\
(\alpha . . \beta) & \lceil\beta \rceil-\lfloor\alpha\rfloor-1 .
\end{array}
$$
\begin{remark}
    \begin{enumerate}
        \item 我们习惯使用左闭右开的括号序列, 因为其具有可加性.
        \item 上述记号在关于求和取整时非常有用, 因为可以迅速的把这些技术的内容收缩下来. 
    \end{enumerate}
    
\end{remark}

\begin{example} 抽奖游戏. 在$[1,1000]$中选一整数. 记抽出数为$n$. 若$\lfloor\sqrt[3]{n}\rfloor \backslash n$(记号$a \backslash b$表示$a$是$b$的正因子), 那么他就赢取了5元. 否则, 他就输了1元. 请求出它玩这个游戏得到的期望. 


        \begin{align*}
            W&= \sum_{n=1}^{1000}[\text{抽到$n$会让我们赢}]\\
             &= \sum_{1 \leqslant n \leqslant 1000}[\lfloor\sqrt[3]{n}\rfloor \backslash n] \varsub{k:=\sqrt[3]{n}}{1.0cm} \sum_{k, n}[k=\lfloor\sqrt[3]{n}\rfloor][k \backslash n][1 \leqslant n \leqslant 1000] \\
             &\varsub{k \backslash n \text { 变形为 }n=km}{2.3cm}\sum_{k, m, n}\left[(k)^3 \leqslant n<(k+1)^3\right][n=k m][1 \leqslant n \leqslant 1000]\\
             &\varsub{\text{换掉}n:=km}{1.5cm} \sum_{k, m}\left[k^3 \leqslant k m<(k+1)^3\right][1 \leqslant k m \leqslant 1000]\\
             &\varsub{m=n/k=n/\lfloor\sqrt[3]n\rfloor}{2.5cm} 1+\sum_{k, m}\left[k^3 \leqslant k m<(k+1)^3\right][1 \leqslant k<10]\\
             &= 1+\sum_{1\leq k\leq 10}^{}(\lceil k^2+3 k+3 + \frac1k\rceil -\left\lceil k^2\right\rceil)\\
            &= 1+\sum_{1 \leqslant k<10}(3 k+4)=172
        \end{align*}
        
        拓展问题: 在$[1..n]$中呢?  记$K$为最大的满足$K^3\leq n$的数字. 也就是我们先求出较为整体的部分. 

        \begin{align*}
            W&=\sum_{1 \leqslant k<K}(3 k+4)+\sum_m\left[K^3 \leqslant K_m<N\right]
             &= =\frac{3}{2} K^2+\frac{5}{2} K-4+\underbrace{\sum_m\left[m \in\left[K^2, N / K\right]\right]}_{\left\lfloor\frac{N}{K}\right\rfloor-K^2+1}
        \end{align*}

        然后可以着手求零碎的部分. 较为零碎的部分并没有很好的封闭表达式, 因此我们只能够讨论它的渐进特性. 这个特性会在后续展开. 
        
\end{example}

\begin{example}
    对于$\alpha \in \mathbb{R}$, $\alpha$的谱是一个多重集, 定义做
    $$
\operatorname{spec}(\alpha):=\{\lfloor\alpha\rfloor,\lfloor 2 \alpha\rfloor, \cdots\}
$$

我们证明两个事实: 

第一, $\alpha \neq \beta \Rightarrow \operatorname{Spec}(\alpha) \neq \operatorname{Spec}(\beta)$. 

证明说: 不妨设$\alpha<\beta$. 我们发现$\exists m$, s.t. $m(\beta-\alpha) \geqslant 1$.(可以取 $\left\lceil\frac{1}{\beta-\alpha}\right\rceil$ ). 由此$m \beta-m \alpha \geqslant 1, \quad m \beta \geqslant 1+m \alpha \Rightarrow\lfloor m \beta\rfloor>\lfloor m \alpha\rfloor$. 因而$\text{Spec}(\beta)$中$\leqslant\lfloor m \alpha\rfloor$
的元素小于$m$个. 而$\operatorname{Spec}(\alpha)$中至少有$m$个$\leqslant\lfloor m \alpha\rfloor$个元素. 这就表示这两个不同的谱序列永远不可能相等.  

第二, $\operatorname{Spec}(\sqrt{2}) \cup \operatorname{Spec}(2+\sqrt{2})={\mathbb{N}}, \quad \operatorname{Spec}(\sqrt{2}) \cap \operatorname{Spec}(2+\sqrt{2})=\varnothing$. 

证明说: 考虑有多少个$\leq n$个元素在$\operatorname{spec}(\sqrt{2})$里面, 有多少个$\leqslant n$的元素在$\operatorname{Spec}(2+\sqrt{2})$里面. 定义$N(\alpha, n)$ 表示 $\operatorname{Spec}(\alpha)$ 中 $\leqslant n$ 的之元素个数.
$$
\begin{aligned}
N(\alpha, n) & =\sum_{k>0}[\lfloor k \alpha\rfloor \leqslant n] \\
& =\sum_{k>0}[\lfloor k \alpha\rfloor<n+1] \\
& =\sum_{k>0}[k \alpha<n+1]=\sum_k\left[0<k<\frac{n+1}{\alpha}\right] \\
& =\left\lceil\frac{n+1}{\alpha}\right\rceil-1 .
\end{aligned}
$$

然后求 $N(\sqrt{2}, n)+N(2+\sqrt{2}, n) \stackrel{?}{=} n$

$$
\begin{aligned}
& \left\lceil\frac{n+1}{\sqrt{2}}\right\rceil-1+\left\lceil\frac{n+1}{2+\sqrt{2}}\right\rceil-1=n \\
& \Leftrightarrow\left\lfloor\frac{n+1}{\sqrt{2}}\right\rfloor+\left\lfloor\frac{n+1}{2+\sqrt{2}}\right\rfloor=n \quad&(\lfloor x\rfloor-\lfloor x\rfloor=[x \text { is not int }]) \\
& \Leftrightarrow \underbrace{\frac{n+1}{\sqrt{2}}+\frac{n+1}{2+\sqrt{2}}}_{n+1}-(\underbrace{\left\{\frac{n+1}{\sqrt{2}}\right\}+\left\{\frac{n+1}{2+\sqrt{2}}\right\}}_{1\text{, 因为两个不是整数的加起来等于整数一定进位了}})=n \\
&
\end{aligned}
$$

这样的结论可推广到 $\frac{1}{\alpha}+\frac{1}{\beta}=1 \Leftrightarrow \operatorname{Spec}( \alpha)  \cup \operatorname{Spec} (\beta)= \mathbb{N}$.

\end{example}

\newpage

\label{sec:mod}
\section{二元运算: 模(mod)运算}

\subsection{模} 我们已经知道了$n／m$的商为$\lfloor n / m\rfloor$, 我们下面定义$n／m$的余数. 

\begin{definition}
$n \bmod m$ 为 $n / m$ 的余数. 即     
$$
n \bmod m:=n-m\left\lfloor\frac{n}{m}\right\rfloor, \forall n, m \in \mathbb{R} ., m \neq 0 .
$$
特别地, 定义$n \bmod 0=n($ 方使起见 $)$. 

\end{definition}

\begin{example}
    $$
\begin{aligned}
& 5 \bmod 3=2 \\
& 5 \bmod (-3)=5-(-3)\left\lfloor\frac{5}{-3}\right\rfloor=5-3 \times 2=-1 \\
& -5 \bmod 3=-5-3\left\lfloor\frac{-5}{3}\right\rfloor=1 \\
& -5 \bmod (-3)=-5-(-3) \times\left\lfloor\frac{-5}{-3}\right\rfloor=-2 . \\
&
\end{aligned}
$$

可见, 对 $x \bmod y$ 而言, 若 $y>0 ,  0 \leqslant x \bmod y<y$; 

$y<0, \quad 0 \geqslant x \bmod y>y .$. 
\end{example}

\begin{example}
    $$
x=\lfloor x\rfloor+\{x\}=\lfloor x\rfloor+x \bmod 1 .
$$
    
\end{example}

同样可以使用上取整定义``不足近似量''.

\begin{definition}
    $$
n \text { mumble }:=m\left\lfloor\frac{n}{m}\right\rceil-n ., \forall n, m \in \mathbb{R}, m \neq 0 \text {. }
$$
    
\end{definition}


\begin{example}
    $$
\begin{aligned}
5 \text { mumble } 3=3\left[\frac{5}{3}\right\rceil-5 & =1 . \\
5 \text { mumble }(-3)=-3\left\lceil\frac{5}{-3}\right\rceil-5 & =-2 \\
-5 \text { mumble } 3 & =2 \\
-5 \text { mumble }-3 \quad & =-1 .
\end{aligned}
$$
    
\end{example}

我们首先注意一个性质: 

\begin{prop}
    $$
c(x \bmod y)=c x \bmod c y
$$
    
\end{prop}

\begin{proof}
    首先验证一般情况: 
    $$
\begin{aligned}
c(x \bmod y)=c\left(x-y\left\lfloor\frac{x}{y}\right\rfloor\right) & =c x-c y\left\lfloor\frac{x}{y}\right\rfloor \\
& =c x-c y\left\lfloor\frac{c x}{c y}\right\rfloor \\
& =c x \bmod c y .
\end{aligned}
$$

然后对于0的情况, 有
$$
c(x \bmod 0)=c x \bmod 0=c x
$$
也成立, 所以上面的性质成立. 
\end{proof}

\begin{example}
    我们希望尽可能平均地将$n$个物品分为$m$份. 如$37=8+8+8+8+5=8+8+7+7+7$. 

    \incfigw{distr}

    可以考虑横着放
    \begin{itemize}
        \item 若 $n \not\backslash m$ , “长的行”将会容纳 $\left\lceil\frac{n}{m}\right\rceil$ 个物品. $(n \bmod m)$
        \item 若 $n \not\backslash m$ , “短的行”将会容纳 $\left\lfloor\frac{n}{m}\right\rfloor$ 个物品. $(n \operatorname{mumble} m)$
    \end{itemize}
    并且两种行最多仅仅相差1. 

    我们考虑另一种方法. 要把$n$个物品“尽可能平均”分为$m$个组时(干脆使用$f(n,m)$表示之),  我们有如下的情况: 
    \begin{enumerate}
        \item 把 $\lceil n / m\rceil$ 个物品放到当前组中
        \item 递归执行$f(n-\lceil n / m\rceil, m-1)$. 
    \end{enumerate}

    比如$m=314, n=6$, 那么有下表格的过程: 

    \begin{center}
        \begin{tabular}{|ccc|}
\hline$n$ & $m$ & $\lceil n / m\rceil$ \\
314 & 6 & 53 \\
261 & 5 & 53 \\
208 & 4 & 52 \\
156 & 3 & 52 \\
104 & 2 & 52 \\
52 & 1 & 52 \\
\hline
\end{tabular}
    \end{center}


    我们来说明这个算法的正确性. 假设$n=\underbrace{q}_{\lfloor n/m \rfloor} m+\underbrace{r}_{n\bmod m}$. 那么
    \begin{enumerate}
        \item 若 $r=0$, 放 $\lceil n / m\rceil=q, f(n-q, n-1)$仍为 $r=0$ 的情形. 
        \item 考 $r>0, f(n-(q+1), n-1)$, 使下一次调用 $r$ 减少 1 .
    \end{enumerate}

    这样一来, 最后一定会到达$r=0$的情形. 

    接下来我们考虑第$k$组有多少物品. 答案是$\left\{\begin{array}{l}\lceil n / m\rceil, 1<k \leqslant n \bmod m \\ \lfloor n / m\rfloor, n \geqslant k > n \bmod m\end{array}\right.$

    稍加改写, 有
    $$
\begin{aligned}
&=q+[k \leqslant r]=q+\left\lceil\frac{r-k+1}{m}\right\rceil \\
&=\left\lceil\frac{r-k+1}{m}\right\rceil+q=\left\lceil\frac{\left.m q+r-k+1\right.}{m}\right\rceil \\
&=\left\lceil\frac{n-k+1}{m}\right\rceil .
\end{aligned}
$$

\end{example}

根据上述的例子, 我们就得到了一个恒等式: 

$$
n=\left\lceil\frac{n}{m}\right\rceil+\left\lceil\frac{n-1}{m}\right\rceil+\cdots+\left\lceil\frac{n-m+1}{m}\right\rceil .
$$

同时我们可以证明下面的命题: 

\begin{prop}

    $$
\begin{aligned}
& n=\underbrace{\left\lfloor\frac{n}{m}\right\rfloor+\left\lfloor\frac{n+1}{m}\right\rfloor+\cdots+\left\lfloor\frac{n+m}{m}\right\rfloor}_{m \text { 项 }} \\
& n=\overbrace{\left\lceil\frac{n}{m}\right\rceil+\left\lceil\frac{n-1}{m}\right\rceil+\cdots+\left\lceil\frac{n-m+1}{m}\right\rceil} \\
&
\end{aligned}
$$
    
\end{prop}

要证明这两个对称的形式, 只要注意到$n=\lceil n / 2\rceil+\lfloor n / 2\rfloor$即可.

将$n$代换为$mx$可以得到如下推论: 

\begin{corollary}
    $$
\lfloor m x\rfloor=\lfloor x\rfloor+\left\lfloor x+\frac{1}{m}\right\rfloor+\cdots+\left\lfloor x+\frac{m-1}{m}\right\rfloor
$$
    
\end{corollary}

\begin{proof}
    \begin{align*}
        \lfloor m x\rfloor&=\left\lfloor\frac{\lfloor m x\rfloor}{m}\right\rfloor+\left\lfloor\frac{\lfloor m x\rfloor+1}{m}\right\rfloor+\cdots+\left\lfloor\frac{\lfloor m x\rfloor+m-1}{m}\right\rfloor \\
                          &\varsub{\text{去掉下取整}}{1.5cm} \lfloor x\rfloor+\left\lfloor x+\frac{1}{m}\right\rfloor+\cdots+\left\lfloor x+\frac{m-1}{m}\right\rfloor
    \end{align*}
    
\end{proof}

\subsection{关于求和的递归式}

接下来看一些关于求和的递归式. 

\begin{example}
    有如下的递推关系: 
    $$
\begin{aligned}
& K_0=1 \\
& K_{n+1}=1+\min \left(2 K_{\lfloor n / 2\rfloor}, 3 K_{\lfloor n / 3\rfloor}\right) .
\end{aligned}
$$
求证$K_n \geqslant n, \forall n \geqslant 0$. 
\end{example}

\begin{proof}
    使用归纳法. 
    \begin{itemize}
        \item $n=0$, 成立.
        \item 假设这个性质对$0,1, \cdots n$成立, 要推是否对$n+1$成立. 由于$K_{n+1}=1+\min \left(2 K_{\lfloor n / 2\rfloor}, 3 K_{\lfloor n / 3\rfloor}\right)$, 以及归纳假设可知: $2 K_{\lfloor n/ 2\rfloor} \geqslant 2\lfloor n / 2\rfloor, 3 K_{\lfloor n / 3\rfloor} \geqslant 3\lfloor n / 3\rfloor$. 根据大小关系分类讨论: 
        \begin{itemize}
            \item 如果 $2\left\lfloor\frac{n}{2}\right\rfloor=n$ 成 $3\left\lfloor\frac{n}{3}\right\rfloor=n$ , 命题得证. 
            \item 如果 $K_{\lfloor n / 2\rfloor}<\frac{n}{2}$ 或 $K_{\lfloor n / 3\rfloor}<n / 3$, 那么以 $K_{\lfloor n / 2\rfloor}<\frac{n}{2}$ 为例, 就可以得到$K_{\left\lfloor n^{\prime} / 2\right\rfloor} \leqslant\left\lfloor\frac{n^{\prime}}{2}\right\rfloor \quad, \quad K_{\left\lfloor\left\lfloor n^{\prime} / 2\right\rfloor / 2\right\rfloor} \leqslant\left\lfloor\frac{n^{\prime}}{4}\right\rfloor$. 这就可以推出$K_0 \leqslant 0$. 但 $K_0=1$ , 矛盾！$K_{\left\lfloor n^{\prime} / 3\right\rfloor} \leqslant\left\lfloor\frac{n^{\prime}}{3}\right\rfloor$ 同理, 此情况不成立!
        \end{itemize}
    \end{itemize}
\end{proof}

\begin{example}
为$\sum_{k=1}^n\lceil\lg k\rceil$ 寻找封闭形式. 

实际上, 本式子是从选择排序的运行时间引申的. 记 $m=\lfloor\lg n\rfloor$, 

$$\begin{aligned} \sum_{k=1}^n\lceil\lg k\rceil & =\sum_{k=1}^{2^m}\lceil\lg k\rceil=j[j=\lceil\lg k\rceil]\left[1 \leqslant k \leqslant 2^m\right] \\ & =\sum_{j, k} j\left[2^{j-1}<k \leqslant 2^j\right][1 \leqslant j \leqslant m] \\ & =\sum_{j=1}^m\left(2^j-2^{j-1}\right) j=2^m(m-1)+1 .\end{aligned}$$

然后再加上 $\lfloor\lg n\rfloor \ldots n$ 的内容, 共有 $(n-m) \cdot(m+1)$项. 故封闭形式为$2^m(m-1)+1+(n-m)(m+1)$.

\end{example}

\begin{example}[Josephus问题]
    求解递归式
    $$
\begin{aligned}
& J(1)=1 \\
& J(n)=2 J\left(\left\lfloor\frac{n}{2}\right\rfloor\right)-(-1)^n, n>1 .
\end{aligned}
$$
的推广: 每隔 $m$ 个人杀死一个. 

我们采取一个新思路, 每一个人经过的时候, 赋予它一个新的编号, 在下面的例子中, 展示的是每隔3个人杀死一个: 

\incfigw{josp}

这样一来, 第 $k$ 个被移除的人拥有号码 $3 k$. 我们按照是不是他们的本身的号码进行分类讨论. 

\begin{itemize}
    \item $N>n$ , 说明轮过一轮了, 若 $(N=n+2 k+1$ 或 $N=n+2 k+2)$, 那么前一个数分别是 $(3 k+1$ 或 $3 k+2)$, 其中 $k=\left\lfloor\frac{N-n-1}{2}\right\rfloor$. 
\end{itemize}

因此寻找最后一个人的代码就可以用如下的伪代码实现: 

$$
\begin{aligned}
& N \leftarrow 3 n \\
& \text { while } N>n, \quad N \leftarrow 3\left\lfloor\frac{N-n-1}{2}\right\rfloor+(N-n-2 k) \\
& J_3(n) \leftarrow N . \quad=\left[\frac{N-n-1}{2}\right\rfloor+N-n \\
&
\end{aligned}
$$

下面做变量代换, 从$3n$到$1$反向编号, 就有

$$
\begin{aligned}
D & +3 n+1-\left(\left\lfloor\frac{(3 n+1-D)-n-1}{2}\right\rfloor+(3 n+1-D)-n\right) \\
& =n+D-\left\lfloor\frac{2 n-D}{2}\right\rfloor=D-\left\lfloor\frac{-D}{2}\right\rfloor=D+\left\lceil\frac{D}{2}\right\rceil=\left\lceil\frac{3}{2} D\right\rceil .
\end{aligned}
$$
    
\end{example}

我们以一段对于数学归纳法的讨论结束这一小节. 

\begin{quote}
    In trying to devise a proof by the Mathematical induction, you may fail for two opposite reasons. You may fail because you try to prove too much, Your $P(n)$ is too heavy a burden; Yet you may also fail because you prove too little, Your $P(n)$ is too weak to support. In general, you have to balance the statement of your theorem so that the support is just enough for the burden. 
    
    \hfill --- G. Polya
\end{quote}

\newpage
\section{关于底和顶的和式}

\subsection{取整: 使用新变量替代} 
在\cref{sec:mod}中, 我们令 $m:=\lfloor\sqrt{k}\rfloor$ , 然后 施用\cref{sec:intro}中得到的$m \leqslant \sqrt{k}<m+1$不等式, 最后使用了计数这个区间里面有多少个整数的方法. 

另一种方法: 使用 $\sum_j[1 \leqslant j \leqslant x]$ 代替 $\lfloor x\rfloor .(x>0)$. 假若 $n=a^2$, 那么

$$\begin{aligned} \sum_{0 \leqslant k<n}\lfloor\sqrt{k}\rfloor & =\sum_{j, k}[1 \leqslant j \leqslant \sqrt{k}]\left[0 \leqslant k \leqslant a^2\right] \\ & =\sum_{1 \leqslant j<a} \sum_k\left[j^2 \leqslant k<a^2\right] \\ & =\sum_{1 \leqslant j<a}\left(a^2-j^2\right)=a^3-\frac{1}{3} a\left(a+\frac{1}{2}\right)(a+1)\end{aligned}$$

\subsection{等差数列的例子} 我们希望求
$$
\sum_{0 \leq k<m}\left\lfloor\frac{n k+x}{m}\right\rfloor, m>0, n \in \mathbb{Z} .
$$
的封闭形式. 

实际上各种情况下, 我们首先要做的事情是观察特例. 
\begin{itemize}
    \item 当$n=1$ 的时候, $\quad x:=\frac{x}{m}$ , 得 $$\left\lfloor\frac{x}{m}\right\rfloor+\left\lfloor\frac{1+x}{m}\right\rfloor+\cdots+\left\lfloor\frac{m-1+x}{m}\right\rfloor=\lfloor x\rfloor.$$
    \item 当$m=2$的时候, 
    $$
    \sum_{0 \leqslant k<m}\left\lfloor\frac{n k+x}{m}\right\rfloor=\left\lfloor\frac{x}{2}\right\rfloor+\left\lfloor\frac{n+x}{2}\right\rfloor
    $$
    分类讨论: 
\begin{enumerate}
    \item $n$ 是偶数: $\left\lfloor\frac{x}{2}\right\rfloor+\left\lfloor\frac{x}{2}\right\rfloor+\frac{n}{2}=2\left\lfloor\frac{x}{2}\right\rfloor+\frac{n}{2}$.
    \item $n$ 是奇数: $\left\lfloor\frac{x}{2}\right\rfloor+\left\lfloor\frac{x+1}{2}\right\rfloor+\frac{n-1}{2}=\lfloor x\rfloor+\frac{n-1}{2}$.
\end{enumerate}
\item 若令 $m=3$ , $$\sum_{0 \leqslant k<m}\left\lfloor\frac{n k+x}{m}\right\rfloor=\left\lfloor\frac{x}{3}\right\rfloor+\left\lfloor\frac{x+n}{3}\right\rfloor+\left\lfloor\frac{x+2 n}{3}\right\rfloor$$ 分类讨论: 
\begin{enumerate}
    \item $n \bmod 3=0: \frac{n}{3}, \frac{2 n}{3} \in \mathbb{Z}$. 和为$$
    \left\lfloor\frac{x}{3}\right\rfloor+\left(\left\lfloor\frac{x}{3}\right\rfloor+\frac{n}{3}\right)+\left(\left\lfloor\frac{x}{3}\right\rfloor+\frac{2 n}{3}\right)=3\left\lfloor\frac{x}{3}\right\rfloor+n
    $$
    \item $n \bmod 3=1, \frac{n-1}{3}, \frac{2(n-1)}{3} \in \mathbb{Z}$. 和为$$\left\lfloor\frac{x}{3}\right\rfloor+\left(\left\lfloor\frac{x+1}{3}\right\rfloor+\frac{n-1}{3}\right)+\left(\left\lfloor\frac{x+2}{3}\right\rfloor+\frac{2 n-2}{3}\right)=\lfloor x\rfloor+n-1$$
    \item $n \bmod 3=2, \frac{n-2}{3}, \frac{2(n-2)}{3}, \frac{2 n-1}{3} \in \mathbb{Z}$, $$\left\lfloor\frac{x}{3}\right\rfloor+\left(\left\lfloor\frac{x+2}{3}\right\rfloor+\frac{n-2}{3}\right)+\left(\left\lfloor\frac{x+1}{3}\right\rfloor+\frac{2 n-1}{3}\right)=\lfloor x\rfloor+n-1.$$
\end{enumerate}
\item 若令 $m=4, \sum_{0 \leq k<m}\left\lfloor\frac{n k+x}{m}\right\rfloor=\left\lfloor\frac{x}{4}\right\rfloor+\left\lfloor\frac{x+n}{4}\right\rfloor+\left\lfloor\frac{x+2 n}{4}\right\rfloor+\left\lfloor\frac{x+3 n}{4}\right\rfloor$. 那就分为4类. 
\item \begin{enumerate}
    \item $n \bmod 4=0$的情况: $$\left\lfloor\frac{x}{4}\right\rfloor+\left(\left\lfloor\frac{x}{4}\right\rfloor+\frac{n}{4}\right)+\left(\left\lfloor\frac{x}{4}\right\rfloor+\frac{2 n}{4}\right)+\left(\left\lfloor\frac{x}{4}\right\rfloor+\frac{3 n}{4}\right)=4\left\lfloor\frac{x}{4}\right\rfloor+\frac{3 n}{2}.$$
    \item $n \bmod 4=1$, $$\begin{aligned}\left\lfloor\frac{x}{4}\right\rfloor+\left(\left\lfloor\frac{x+1}{4}\right\rfloor+\frac{n-1}{4}\right)+\left(\left\lfloor\frac{x+2}{4}\right\rfloor+\frac{2 n-2}{4}\right) & +\left(\left\lfloor\frac{x+3}{4}\right\rfloor+\frac{3 n-3}{4}\right) \\ & =\lfloor x\rfloor+\frac{3 n}{2}-\frac{3}{2}\end{aligned}.$$
    \item $n \bmod 4=2$, $$\begin{aligned} & \left\lfloor\frac{x}{4}\right\rfloor+\left(\left\lfloor\frac{x+2}{4}\right\rfloor+\frac{n-2}{4}\right)+\left(\left\lfloor\frac{x}{4}\right\rfloor+\frac{2 n}{4}\right)+\left(\left\lfloor\frac{x+2}{4}\right\rfloor+\frac{3 n-2}{4}\right) \\ = & 2\left(\left\lfloor\frac{x}{4}\right\rfloor+\left\lfloor\frac{x+2}{4}\right\rfloor\right)+\frac{3 n}{2}-1=2\left\lfloor\frac{x}{2}\right\rfloor+\frac{3 n}{2}-1 .\end{aligned}$$
    \item $n \bmod 4=3$, $$\left\lfloor\frac{x}{4}\right\rfloor+\left(\left\lfloor\frac{x+1}{4}\right\rfloor+\frac{3 n-1}{4}\right)+\left(\left\lfloor\frac{x+2}{4}\right\rfloor+\frac{2 n-2}{4}\right)+\left(\left\lfloor\frac{x+3}{4}\right\rfloor+\frac{n-3}{4}\right)=\lfloor x \rfloor+\frac{3 n}{2}-\frac{3}{2}.$$
\end{enumerate}
\end{itemize}

总结为表格, 就有





\end{document}
